---
layout: default
nav_order: 20
title: "Услуга не может быть оказана"
parent: "Обработка уведомлений"
grand_parent: "Приём платежей"
date: 2024-04-02 00:00:00 +0300
---

# Услуга не может быть оказана или товар не может быть доставлен

Как правило, система «Инвойсбокс» уведомляет Магазин о факте оплаты счёта асинхронно от действий
покупателя на платёжной странице. Т.е. покупатель подтверждает оплату заказа в интерфейсе «Инвойсбокс»,
возвращается на страницу магазина, а уведомление об оплате счёта асинхронно передаётся системой
«Инвойсбокс» в магазин по API.

В некоторых сценариях, требуется контролировать факт успешной доставки уведомления об оплате до
Магазина и уведомлять пользователя о таком процессе. Например, по факту оплаты требуется подтвердить
наличие товара на складе и зарезервировать его или же, по факту оплаты требуется забронировать
места/номера/время и оформить билет. Такие сценарии как правило используются совместно с 
гарантийными оплатами (предавторизация денежных средств на банковской карте или использование
гарантийного фонда).

{: .important }
> Использование сценария требует включения настройки платёжной страницы Магазина "Контроль отгрузки на
платёжной странице". В случае, если у вас возникнут сложности при самостоятельной настройке,
пожалуйста, обратитесь к специалистам [службы поддержки](https://www.invoicebox.ru/ru/contacts/feedback.html).

## Пример сценария

Покупатель подтверждает оплату счёта на платёжной странице. Платёжная страница отображает покупателю
загрузчик (лоадер ⌛). Система «Инвойсбокс» уведомляет Магазин о факте оплаты счёта и ожидает ответ.

Система Магазина выполняет свою логику по резервированию товара или бронированию услуги.

### ✅ Позитивный сценарий

Система Магазина успешно резервирует товар или бронирует услугу. В этом случае, в ответ на запрос
«Инвойсбокс», система Магазина возвращает статус `success`.

Покупателю на платёжной странице отображается информация об успешном подтверждении оплаты, покупатель
перенаправляется в Магазин на страницу успешной оплаты заказа.

### ❌ Негативный сценарий

При попытке резервирования товара или бронирования услуги, система Магазина получает ошибку. В
этом случае, в ответ на запрос «Инвойсбокс», система Магазина возвращает статус `error` с кодом
`shipping_unavailable` (Услуга не может быть оказана или товар не может быть доставлен).

Покупателю на платёжной странице отображается информация о невозможности оказания услуги, а также
дальнейшие инструкции о том, как и когда платёж будет отменён. Покупатель перенаправляется в Магазин
на страницу ошибки при оплате заказа.

### Отмена оплаты и возврат денежных средств

Обратите внимание, негативный ответ на уведомление об оплате счёта, не инициирует процессы возврата.
Магазин должен самостоятельно инициировать процессы возврата в случае невозможности поставки товара
или оказания услуги.

В случае, если оплата заказа была подтверждена с использованием гарантийного платежа, Магазин может
вызвать [метод отмены заказа](/docs/merchant/order/delete/) для полного возврата средств покупателю
(отмены гарантийной оплаты, reverse).

В случае, если оплата заказа была подтверждена с использованием иных платёжных инструментов, Магазин
может вызвать [метод возврата по заказу](/docs/merchant/refund) для полного или частичного возврата
средств покупателю.


---

[Читать далее &raquo;](/docs/dictionary){: .btn .btn-primary .mb-4 .mb-md-0 .mr-2 }
